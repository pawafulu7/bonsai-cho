---
/**
 * Admin Layout
 *
 * Layout for admin dashboard pages.
 * Authentication is handled by middleware - admin user data is available in Astro.locals.
 */
import BaseLayout from "./BaseLayout.astro";
import { AdminLayoutClient } from "@/components/admin/AdminLayoutClient";

interface Props {
  title?: string;
  description?: string;
}

const { title = "管理画面", description = "盆栽帳 管理画面" } = Astro.props;

// Admin user is guaranteed to exist here (middleware redirects if not authenticated)
const admin = Astro.locals.adminUser!;

const currentPath = Astro.url.pathname;

// Create user object for client component
const adminUser = {
  id: admin.id,
  name: admin.name,
  email: admin.email,
  avatarUrl: null, // Admin users don't have avatars (password-based auth)
};
---

<BaseLayout title={title} description={description}>
  <AdminLayoutClient
    client:load
    currentPath={currentPath}
    user={adminUser}
  >
    <slot />
  </AdminLayoutClient>
</BaseLayout>
