---
/**
 * Admin Layout
 *
 * Layout for admin dashboard pages.
 * Authentication is handled by middleware - user data is available in Astro.locals.
 */
import BaseLayout from "./BaseLayout.astro";
import { AdminLayoutClient } from "@/components/admin/AdminLayoutClient";

interface Props {
  title?: string;
  description?: string;
}

const { title = "管理画面", description = "盆栽帳 管理画面" } = Astro.props;

// User is guaranteed to exist here (middleware redirects if not authenticated/admin)
const user = Astro.locals.user!;

const currentPath = Astro.url.pathname;

// Create user object for client component
const adminUser = {
  id: user.id,
  name: user.name,
  email: user.email,
  avatarUrl: user.avatarUrl,
};
---

<BaseLayout title={title} description={description}>
  <AdminLayoutClient
    client:load
    currentPath={currentPath}
    user={adminUser}
  >
    <slot />
  </AdminLayoutClient>
</BaseLayout>
